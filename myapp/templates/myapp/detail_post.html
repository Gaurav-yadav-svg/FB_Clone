{% extends 'myapp/base.html'%}
{% block content %}
    <!-- style="color :red;" -->
    <div style="align-items: center; text-align: center; margin: 15px 15px; display: flex; justify-content: center;">
      <div class="card" style="width: 45%; height: 513px;">
        <div class="card-body">
        <h2> Post Detail</h2>

    <p style="font-weight : bold; font-size: 20px; " >{{object.user.username}}</p>
    <img src= "{{object.post_img.url}}" alt="Not Showing" width="400" >

    {% if user.is_authenticated %}
    {% csrf_token %}     
        <span style="display: block; font-weight: bold; margin-top: 10px;" class="" id="like_count">{{ object.news_likes_count }}</span>
        <button class="like-button" value="{{ object.id }}" style="margin: 12px 12px;"> Like </button>
  {% endif %}
    <p>{{object.caption}}</p>
    </div>
  </div>
</div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>

    $(document).on('click', '.like-button', function (e) {
      e.preventDefault();
      $.ajax({
        type: 'POST',
        url: '{% url "like" %}',
        data: {
          postid: $(this).val(),
          csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val(),
          action: 'post'
        },
        success: function (json) {
          console.log(json);
          
          document.getElementById("like_count").innerHTML = json['result']
        },
        error: function(xhr, errmsg, err) {
  
        }
      });
    })
  
  </script>
{% endblock %}